!function($,e,t){var i=["p","div","pre","form"],n=[8,9,17,18,37,38,39,40,91,46];$.emojiarea={assetsPath:"",spriteSheetPath:"",blankGifPath:"",iconSize:25,icons:{}};var a=":joy:,:kissing_heart:,:heart:,:heart_eyes:,:blush:,:grin:,:+1:,:relaxed:,:pensive:,:smile:,:sob:,:kiss:,:unamused:,:flushed:,:stuck_out_tongue_winking_eye:,:see_no_evil:,:wink:,:smiley:,:cry:,:stuck_out_tongue_closed_eyes:,:scream:,:rage:,:smirk:,:disappointed:,:sweat_smile:,:kissing_closed_eyes:,:speak_no_evil:,:relieved:,:grinning:,:yum:,:laughing:,:ok_hand:,:neutral_face:,:confused:".split(",");$.fn.emojiarea=function(e){return e=$.extend({},e),this.each((function(){var i=$(this);if("contentEditable"in t.body&&!1!==e.wysiwyg){var n=getGuid();new c(i,n,$.extend({},e))}else{n=getGuid();new r(i,n,e)}i.attr({"data-emojiable":"converted","data-id":n,"data-type":"original-input"})}))};var o={};o.restoreSelection=e.getSelection?function(t){var i=e.getSelection();i.removeAllRanges();for(var n=0,a=t.length;n<a;++n)i.addRange(t[n])}:t.selection&&t.selection.createRange?function(e){e&&e.select()}:void 0,o.saveSelection=e.getSelection?function(){var t=e.getSelection(),i=[];if(t.rangeCount)for(var n=0,a=t.rangeCount;n<a;++n)i.push(t.getRangeAt(n));return i}:t.selection&&t.selection.createRange?function(){var e=t.selection;return"none"!==e.type.toLowerCase()?e.createRange():null}:void 0,o.replaceSelection=e.getSelection?function(i){var n,a=e.getSelection(),o="string"==typeof i?t.createTextNode(i):i;a.getRangeAt&&a.rangeCount&&((n=a.getRangeAt(0)).deleteContents(),n.insertNode(o),n.setStart(o,0),e.setTimeout((function(){(n=t.createRange()).setStartAfter(o),n.collapse(!0),a.removeAllRanges(),a.addRange(n)}),0))}:t.selection&&t.selection.createRange?function(e){var i=t.selection.createRange();"string"==typeof e?i.text=e:i.pasteHTML(e.outerHTML)}:void 0,o.insertAtCursor=function(e,i){e=" "+e;var n,a,o=i.value;void 0!==i.selectionStart&&void 0!==i.selectionEnd?(n=i.selectionStart,i.selectionEnd,i.value=o.substring(0,n)+e+o.substring(i.selectionEnd),i.selectionStart=i.selectionEnd=n+e.length):void 0!==t.selection&&void 0!==t.selection.createRange&&(i.focus(),(a=t.selection.createRange()).text=e,a.select())},o.extend=function(e,t){if(void 0!==e&&e||(e={}),"object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},o.escapeRegex=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},o.htmlEntities=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},o.emojiInserted=function(e,t){ConfigStorage.get("emojis_recent",(function(t){var i=(t=t||a||[]).indexOf(e);if(!i)return!1;-1!=i&&t.splice(i,1),t.unshift(e),t.length>42&&(t=t.slice(42)),ConfigStorage.set({emojis_recent:t})}))};var s=function(){};s.prototype.setup=function(){var e=this;this.$editor.on("focus",(function(){e.hasFocus=!0})),this.$editor.on("blur",(function(){e.hasFocus=!1})),e.emojiMenu=new l(e),this.setupButton()},s.prototype.setupButton=function(){var e=this,t=$("[data-id="+this.id+"][data-type=picker]");t.on("click",(function(t){e.emojiMenu.show(e)})),this.$button=t,this.$dontHideOnClick="emoji-picker"},s.createIcon=function(e,t){var i=e[0],n=e[1],a=e[2],s=e[3],r=$.emojiarea.spriteSheetPath?$.emojiarea.spriteSheetPath:$.emojiarea.assetsPath+"/emoji_spritesheet_!.png",c=$.emojiarea.blankGifPath?$.emojiarea.blankGifPath:$.emojiarea.assetsPath+"/blank.gif",l=t&&Config.Mobile?26:$.emojiarea.iconSize,h=-l*a,d=-l*n,u=Config.EmojiCategorySpritesheetDimens[i][1]*l,p=Config.EmojiCategorySpritesheetDimens[i][0]*l,m="display:inline-block;";return m+="width:"+l+"px;",m+="height:"+l+"px;",m+="background:url('"+r.replace("!",i)+"') "+h+"px "+d+"px no-repeat;",'<img src="'+c+'" class="img" style="'+(m+="background-size:"+u+"px "+p+"px;")+'" alt="'+o.htmlEntities(s)+'">'},$.emojiarea.createIcon=s.createIcon;var r=function(e,t,i){this.options=i,this.$textarea=e,this.$editor=e,this.id=t,this.setup()};r.prototype.insert=function(e){$.emojiarea.icons.hasOwnProperty(e)&&(o.insertAtCursor(e,this.$textarea[0]),o.emojiInserted(e,this.menu),this.$textarea.trigger("change"))},r.prototype.val=function(){return"\n"==this.$textarea?"":this.$textarea.val()},o.extend(r.prototype,s.prototype);var c=function(i,a,s){var r=this;this.options=s||{},"unicode"===$(i).attr("data-emoji-input")?this.options.inputMethod="unicode":this.options.inputMethod="image",this.id=a,this.$textarea=i,this.emojiPopup=s.emojiPopup,this.$editor=$("<div>").addClass("emoji-wysiwyg-editor").addClass($(i)[0].className),this.$editor.data("self",this),i.attr("maxlength")&&this.$editor.attr("maxlength",i.attr("maxlength")),this.$editor.height(i.outerHeight()),this.emojiPopup.appendUnicodeAsImageToElement(this.$editor,i.val()),this.$editor.attr({"data-id":a,"data-type":"input",placeholder:i.attr("placeholder"),contenteditable:"true"});var c="blur change";this.options.norealTime||(c+=" keyup"),this.$editor.on(c,(function(e){return r.onChange.apply(r,[e])})),this.$editor.on("mousedown focus",(function(){t.execCommand("enableObjectResizing",!1,!1)})),this.$editor.on("blur",(function(){t.execCommand("enableObjectResizing",!0,!0)}));var l=this.$editor;this.$editor.on("change keydown keyup resize scroll",(function(e){-1!=n.indexOf(e.which)||(e.ctrlKey||e.metaKey)&&65==e.which||(e.ctrlKey||e.metaKey)&&67==e.which||!(l.text().length+l.find("img").length>=l.attr("maxlength"))||e.preventDefault(),r.updateBodyPadding(l)})),this.$editor.on("paste",(function(i){var n;i.preventDefault();var a=l.attr("maxlength")-(l.text().length+l.find("img").length);(i.originalEvent||i).clipboardData?(n=(i.originalEvent||i).clipboardData.getData("text/plain"),r.options.onPaste&&(n=r.options.onPaste(n)),a<n.length&&(n=n.substring(0,a)),t.execCommand("insertText",!1,n)):e.clipboardData&&(n=e.clipboardData.getData("Text"),r.options.onPaste&&(n=r.options.onPaste(n)),a<n.length&&(n=n.substring(0,a)),t.selection.createRange().pasteHTML(n)),l.scrollTop(l[0].scrollHeight)})),i.after("<i class='emoji-picker-icon emoji-picker "+this.options.popupButtonClasses+"' data-id='"+a+"' data-type='picker'></i>"),i.hide().after(this.$editor),this.setup(),$(t.body).on("mousedown",(function(){r.hasFocus&&(r.selection=o.saveSelection())}))};c.prototype.updateBodyPadding=function(e){var t=$("[data-id="+this.id+"][data-type=picker]");$(e).hasScrollbar()?(t.hasClass("parent-has-scroll")||t.addClass("parent-has-scroll"),$(e).hasClass("parent-has-scroll")||$(e).addClass("parent-has-scroll")):(t.hasClass("parent-has-scroll")&&t.removeClass("parent-has-scroll"),$(e).hasClass("parent-has-scroll")&&$(e).removeClass("parent-has-scroll"))},c.prototype.onChange=function(e){var t=new CustomEvent("input",{bubbles:!0});this.$textarea.val(this.val())[0].dispatchEvent(t)},c.prototype.insert=function(e){var t="";if("unicode"==this.options.inputMethod)t=this.emojiPopup.colonToUnicode(e);else{var i=$(s.createIcon($.emojiarea.icons[e]));i[0].attachEvent&&i[0].attachEvent("onresizestart",(function(e){e.returnValue=!1}),!1),t=i[0]}this.$editor.trigger("focus"),this.selection&&o.restoreSelection(this.selection);try{o.replaceSelection(t)}catch(e){}o.emojiInserted(e,this.menu),this.onChange()},c.prototype.val=function(){for(var e=[],t=[],n=this.emojiPopup,a=function(){e.push(t.join("")),t=[]},o=function(e){if(3===e.nodeType)t.push(e.nodeValue);else if(1===e.nodeType){var n=e.tagName.toLowerCase(),s=-1!==i.indexOf(n);if(s&&t.length&&a(),"img"===n){var r=e.getAttribute("alt")||"";return void(r&&t.push(r))}"br"===n&&a();for(var c=e.childNodes,l=0;l<c.length;l++)o(c[l]);s&&t.length&&a()}},s=this.$editor[0].childNodes,r=0;r<s.length;r++)o(s[r]);t.length&&a();var c=e.join("\n");return n.colonToUnicode(c)},o.extend(c.prototype,s.prototype),jQuery.fn.hasScrollbar=function(){var e=this.get(0).scrollHeight;return this.outerHeight()<e};var l=function(i){var n=this;n.id=i.id;var a=$(t.body);$(e);this.visible=!1,this.emojiarea=i,l.menuZIndex=5e3,this.$menu=$("<div>"),this.$menu.addClass("emoji-menu"),this.$menu.attr("data-id",n.id),this.$menu.attr("data-type","menu"),this.$menu.hide(),this.$itemsTailWrap=$('<div class="emoji-items-wrap1"></div>').appendTo(this.$menu),this.$categoryTabs=$('<table class="emoji-menu-tabs"><tr><td><a class="emoji-menu-tab icon-recent" ></a></td><td><a class="emoji-menu-tab icon-smile" ></a></td><td><a class="emoji-menu-tab icon-flower"></a></td><td><a class="emoji-menu-tab icon-bell"></a></td><td><a class="emoji-menu-tab icon-car"></a></td><td><a class="emoji-menu-tab icon-grid"></a></td></tr></table>').appendTo(this.$itemsTailWrap),this.$itemsWrap=$('<div class="emoji-items-wrap mobile_scrollable_wrap"></div>').appendTo(this.$itemsTailWrap),this.$items=$('<div class="emoji-items">').appendTo(this.$itemsWrap),this.emojiarea.$editor.after(this.$menu),a.on("keydown",(function(e){27!==e.keyCode&&9!==e.keyCode||n.hide()})),a.on("message_send",(function(e){n.hide()})),a.on("mouseup",(function(t){var i=(t=t.originalEvent||t).target||e;if(!$(i).hasClass(n.emojiarea.$dontHideOnClick)){for(;i&&i!=e;)if((i=i.parentNode)==n.$menu[0]||n.emojiarea&&i==n.emojiarea.$button[0])return;n.hide()}})),this.$menu.on("mouseup","a",(function(e){return e.stopPropagation(),!1})),this.$menu.on("click","a",(function(t){if(n.emojiarea.updateBodyPadding(n.emojiarea.$editor),$(this).hasClass("emoji-menu-tab"))return n.getTabIndex(this)!==n.currentCategory&&n.selectCategory(n.getTabIndex(this)),!1;var i=$(".label",$(this)).text();return e.setTimeout((function(){n.onItemSelected(i),(t.ctrlKey||t.metaKey)&&n.hide()}),0),t.stopPropagation(),!1})),this.selectCategory(0)};l.prototype.getTabIndex=function(e){return this.$categoryTabs.find(".emoji-menu-tab").index(e)},l.prototype.selectCategory=function(e){this.$categoryTabs.find(".emoji-menu-tab").each((function(t){t===e?this.className+="-selected":this.className=this.className.replace("-selected","")})),this.currentCategory=e,this.load(e)},l.prototype.onItemSelected=function(e){this.emojiarea.$editor.text().length+this.emojiarea.$editor.find("img").length>=this.emojiarea.$editor.attr("maxlength")||this.emojiarea.insert(e)},l.prototype.load=function(e){var t=[],i=$.emojiarea.icons,n=$.emojiarea.assetsPath,r=this;n.length&&"/"!==n.charAt(n.length-1)&&(n+="/");var c=function(){r.$items.html(t.join(""))};if(e>0){for(var l in i)i.hasOwnProperty(l)&&i[l][0]===e-1&&t.push('<a href="javascript:void(0)" title="'+o.htmlEntities(l)+'">'+s.createIcon(i[l],!0)+'<span class="label">'+o.htmlEntities(l)+"</span></a>");c()}else ConfigStorage.get("emojis_recent",(function(e){var n,r;for(e=e||a||[],r=0;r<e.length;r++)n=e[r],i[n]&&t.push('<a href="javascript:void(0)" title="'+o.htmlEntities(n)+'">'+s.createIcon(i[n],!0)+'<span class="label">'+o.htmlEntities(n)+"</span></a>");c()}))},l.prototype.hide=function(e){this.visible=!1,this.$menu.hide("fast")},l.prototype.show=function(e){if(this.visible)return this.hide();$(this.$menu).css("z-index",++l.menuZIndex),this.$menu.show("fast"),this.currentCategory||this.load(0),this.visible=!0}}(jQuery,window,document);